---
import { topSwitch } from "../config/nav";
import HamburgerMenu from "./HamburgerMenu.astro";

const pathname = Astro.url.pathname;

// 現在地ハイライト（/ は完全一致、それ以外は prefix一致）
const isActive = (href: string) => (href === "/" ? pathname === "/" : pathname.startsWith(href));
---

<header class="sticky top-0 z-50 bg-white/80 border-b border-base-300">
  <div class="mx-auto max-w-6xl px-4 flex items-end justify-between gap-3 min-w-0 pb-0" style="padding-top: 0.75rem;">
    <!-- 左：ロゴ -->
    <a href="/" class="flex items-center gap-2 shrink-0 mb-1">
      <img src="/images/logo/logo-w512.png" alt="おいらの森ロゴ" class="h-7 w-auto" />
      <span class="sr-only">おいらの森</span>
    </a>

    <!-- 中央：世界切替 -->
    <nav class="flex items-end gap-2 header-tabs min-w-0">
      {topSwitch.map((item) => (
        <a
          href={item.href}
          class={
            "header-tab " +
            (isActive(item.href) ? "is-active " : "") +
            (item.href === "/" ? "is-light" : "is-deep")
          }
          aria-current={isActive(item.href) ? "page" : undefined}
        >
          {item.href === "/" ? (
            <>
              {/* スマホ：2行（意図した改行） */}
              <span class="block sm:hidden leading-[1.05] text-center">
                Light<br />Forest
              </span>
              {/* sm以上：日本語 */}
              <span class="hidden sm:inline">ライトフォレスト</span>
            </>
          ) : (
            <>
              {/* スマホ：2行（意図した改行） */}
              <span class="block sm:hidden leading-[1.05] text-center">
                Deep<br />Forest
              </span>
              {/* sm以上：日本語 */}
              <span class="hidden sm:inline">ディープフォレスト</span>
            </>
          )}
        </a>
      ))}
    </nav>



    <!-- 右：天気（ダミー）＋ハンバーガー -->
    <div class="flex items-center gap-2 mb-1">
      <a
        href="/now/"
        class="btn btn-ghost btn-sm flex items-center gap-2  hidden sm:flex"
        aria-label="現在の天気"
        title="現在の天気（ダミー）"
      >
        <!-- きれいめ簡易アイコン（SVG） -->
        <svg
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <circle cx="12" cy="12" r="4"></circle>
          <path d="M12 2v2"></path>
          <path d="M12 20v2"></path>
          <path d="M4.93 4.93l1.41 1.41"></path>
          <path d="M17.66 17.66l1.41 1.41"></path>
          <path d="M2 12h2"></path>
          <path d="M20 12h2"></path>
          <path d="M4.93 19.07l1.41-1.41"></path>
          <path d="M17.66 6.34l1.41-1.41"></path>
        </svg>

        <span class="tabular-nums">15.2℃</span>
      </a>

      <HamburgerMenu />
    </div>
  </div>
</header>
